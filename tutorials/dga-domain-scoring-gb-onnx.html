<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" />

    <!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>DGA domain scoring (GB-ONNX) - ML Model Manager Client documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">ML Model Manager Client  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">ML Model Manager Client  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../user_guide/index.html">Userâ€™s Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/client-object.html">Client Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/functions-facade.html">Functions Facade</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/authentication.html">Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/downloaders.html">Downloaders</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="dga-domain-classifier.html">DGA domain classifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="dga-domain-classifier-keras-onnx.html">DGA domain classifier (Keras-ONNX)</a></li>
<li class="toctree-l2"><a class="reference internal" href="entity-classification-kmeans-onnx.html">Entity classification (kmeans-ONNX)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api_reference/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/modelmanager.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">devo_ml.modelmanager</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/api.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">devo_ml.modelmanager.api</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/auth.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">devo_ml.modelmanager.auth</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/downloader.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">devo_ml.modelmanager.downloader</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/engines.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">devo_ml.modelmanager.engines</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/error.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">devo_ml.modelmanager.error</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/profile.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">devo_ml.modelmanager.profile</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/validator.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">devo_ml.modelmanager.validator</span></code></a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="dga-domain-scoring-gb-onnx">
<h1>DGA domain scoring (GB-ONNX)<a class="headerlink" href="#dga-domain-scoring-gb-onnx" title="Permalink to this heading">#</a></h1>
<p>This tutorial shows how to perform real-time <cite>DGA</cite> domain classification using
a machine learning model to have as output the classification probability
<cite>(score)</cite>.</p>
<p>We will use the
<a class="reference external" href="https://en.wikipedia.org/wiki/Gradient_boosting">Gradient Boosting</a>
algorithm from the <a class="reference external" href="https://scikit-learn.org/">scikit-learn</a> library to
create a model capable of detecting whether a domain is malicious. Then we will
transform the model into <a class="reference external" href="https://onnx.ai/">ONNX</a> format in order to
aggregate the scoring of the classification. Finally, we will register the
model in <strong>ML Model Manager</strong> to enable it in the <a class="reference external" href="https://www.devo.com">Devo</a>
platform and exploit it through Devo query engine.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://github.com/DevoInc/python-mlmodelmanager-client/blob/main/notebooks/dga-domain-scoring-gb-onnx.ipynb">The tutorial is available as a Jupyter notebook</a>.</p>
</div>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Python &gt;= 3.7.</p></li>
<li><p>Devo table <code class="docutils literal notranslate"><span class="pre">demo.ecommerce.data</span></code>.</p></li>
</ul>
<p>It is recommended for convenience to create a virtual environment to run the
tutorial or use the notebook provided.</p>
</section>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h2>
<p>Letâ€™s start by installing the required packages. Open your favourite terminal
and type the following command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>devo-sdk<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>devo-mlmodelmanager<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>numpy<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>onnx<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>onnxruntime<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>pandas<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>scikit-learn<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>skl2onnx
</pre></div>
</div>
<p>We are ready to start coding, so in your coding environment letâ€™s start by
the needed imports.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">onnx</span> <span class="kn">import</span> <span class="n">TensorProto</span>
<span class="kn">from</span> <span class="nn">onnx.defs</span> <span class="kn">import</span> <span class="n">ONNX_ML_DOMAIN</span>
<span class="kn">from</span> <span class="nn">onnx.helper</span> <span class="kn">import</span> <span class="n">make_node</span><span class="p">,</span> <span class="n">make_tensor_value_info</span>
<span class="kn">from</span> <span class="nn">onnxruntime</span> <span class="kn">import</span> <span class="n">InferenceSession</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">skl2onnx</span> <span class="kn">import</span> <span class="n">convert_sklearn</span><span class="p">,</span> <span class="n">to_onnx</span>
<span class="kn">from</span> <span class="nn">skl2onnx.common.data_types</span> <span class="kn">import</span> <span class="n">FloatTensorType</span>
<span class="kn">from</span> <span class="nn">devo.api</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">ClientConfig</span><span class="p">,</span> <span class="n">SIMPLECOMPACT_TO_OBJ</span>
<span class="kn">from</span> <span class="nn">devo_ml.modelmanager</span> <span class="kn">import</span> <span class="n">create_client_from_token</span><span class="p">,</span> <span class="n">engines</span>
</pre></div>
</div>
<p>Declare some constants for convenience in the code.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="c1"># A valid Devo access token</span>
  <span class="n">DEVO_TOKEN</span> <span class="o">=</span> <span class="s1">&#39;&lt;your_token_here&gt;&#39;</span>

  <span class="c1"># URL of Devo API, e.g. https://apiv2-us.devo.com/search/query/</span>
  <span class="n">DEVO_API_URL</span> <span class="o">=</span> <span class="s1">&#39;&lt;devo_api_url_here&gt;&#39;</span>

  <span class="c1"># URL of Devo ML Model Manager, e.g. https://api-us.devo.com/mlmodelmanager/</span>
  <span class="n">DEVO_MLMM_URL</span> <span class="o">=</span> <span class="s1">&#39;&lt;devo_mlmm_url_here&gt;&#39;</span>

  <span class="c1"># The domain to connect to, e.g. self</span>
  <span class="n">DOMAIN</span> <span class="o">=</span> <span class="s1">&#39;&lt;your_domain_here&gt;&#39;</span>

  <span class="c1"># The name of the model</span>
  <span class="n">MODEL_NAME</span> <span class="o">=</span> <span class="s1">&#39;dga_scoring&#39;</span>

  <span class="c1"># The description of the models</span>
  <span class="n">MODEL_DESCRIPTION</span> <span class="o">=</span> <span class="s1">&#39;DGA domain label scoring&#39;</span>

  <span class="c1"># File to store the onnx model</span>
  <span class="n">MODEL_FILE</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">MODEL_NAME</span><span class="si">}</span><span class="s1">.onnx&#39;</span>

  <span class="c1"># The URL of a dataset to build the model</span>
  <span class="n">DATASET_URL</span> <span class="o">=</span> <span class="s2">&quot;https://devo-ml-models-public-demos.s3.eu-west-3.amazonaws.com/legit_dga/dataset.csv&quot;</span>

<span class="c1"># Random seed to initialize random variables</span>
  <span class="n">RANDOM_SEED</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>
</div>
</section>
<section id="prepare-the-data">
<h2>Prepare the data<a class="headerlink" href="#prepare-the-data" title="Permalink to this heading">#</a></h2>
<p>This <a class="reference external" href="https://devo-ml-models-public-demos.s3.eu-west-3.amazonaws.com/legit_dga/dataset.csv">dataset</a>
will help us to train our model once it has been built. The dataset has the
form <code class="docutils literal notranslate"><span class="pre">host;domain;class;subclass</span></code>.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>host;domain;class;subclass
000directory.com.ar;000directory;legit;legit
001fans.com;001fans;legit;legit
...
1002n0q11m17h017r1shexghfqf.net;1002n0q11m17h017r1shexghfqf;dga;newgoz
100bestbuy.com;100bestbuy;legit;legit
...
</pre></div>
</div>
<p>With the <a class="reference external" href="https://pandas.pydata.org/">pandas</a> library we can handle and
transform data in a simple way, so create a <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">pandas.DataFrame</a> from the
dataset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">DATASET_URL</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is the dataset as a <cite>pandas.DataFrame</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">                  host          domain  class subclass</span>
<span class="go">0  000directory.com.ar    000directory  legit    legit</span>
<span class="go">1       000webhost.com      000webhost  legit    legit</span>
<span class="go">2          001fans.com         001fans  legit    legit</span>
<span class="go">3   01-telecharger.com  01-telecharger  legit    legit</span>
<span class="go">4       010shangpu.com      010shangpu  legit    legit</span>
</pre></div>
</div>
<p>We need to add the columns <code class="docutils literal notranslate"><span class="pre">length</span></code>,
<code class="docutils literal notranslate"><span class="pre">entropy</span></code> and <code class="docutils literal notranslate"><span class="pre">vowel_proportion</span></code> for each domain, and also the flag
<code class="docutils literal notranslate"><span class="pre">malicious</span></code> indicating if it is a DGA domain according to the <code class="docutils literal notranslate"><span class="pre">class</span></code>
column value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">entropy</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper function to calculate the Shannon entropy of a text.&quot;&quot;&quot;</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">text</span><span class="p">)]</span>
    <span class="k">return</span> <span class="o">-</span><span class="nb">sum</span><span class="p">([</span><span class="n">p</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prob</span><span class="p">])</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;subclass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;vowel_proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="s2">&quot;aeiou&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;entropy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">entropy</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;malicious&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span> <span class="o">!=</span> <span class="s1">&#39;legit&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>This is the dataset ready to use.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">                  host          domain  class subclass  length  vowel_proportion   entropy  malicious</span>
<span class="go">0  000directory.com.ar    000directory  legit    legit      12          0.250000  3.022055          0</span>
<span class="go">1       000webhost.com      000webhost  legit    legit      10          0.200000  2.846439          0</span>
<span class="go">2          001fans.com         001fans  legit    legit       7          0.142857  2.521641          0</span>
<span class="go">3   01-telecharger.com  01-telecharger  legit    legit      14          0.285714  3.324863          0</span>
<span class="go">4       010shangpu.com      010shangpu  legit    legit      10          0.200000  3.121928          0</span>
</pre></div>
</div>
</section>
<section id="build-the-model">
<h2>Build the model<a class="headerlink" href="#build-the-model" title="Permalink to this heading">#</a></h2>
<p>We are now ready to build the model. We will rely on a
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html/">sklearn GradientBoostingClassifier</a> for that.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="s1">&#39;vowel_proportion&#39;</span><span class="p">,</span> <span class="s1">&#39;entropy&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;malicious&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Split the data in test and train chunks</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_SEED</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_SEED</span><span class="p">)</span>

<span class="c1"># Train the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
<p>We can now check the accuracy of our model. We will use the
<a class="reference external" href="https://en.wikipedia.org/wiki/F-score">F-score</a> measure provided by the
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html">sklearn.metrics.f1_score</a>
function.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">X_test</span></code> chunk splited before allows us to validate the model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Validate how good is the model</span>
<span class="n">pred_test</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred_test</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;F1-Score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">F1-Score: 0.9199</span>
</pre></div>
</div>
<p><cite>F1 score</cite> reaches its best value at <code class="docutils literal notranslate"><span class="pre">1</span></code> and worst score at <code class="docutils literal notranslate"><span class="pre">0</span></code>. We have
<code class="docutils literal notranslate"><span class="pre">0.9199</span></code>, so our model has a goog accuracy. So far so good.</p>
</section>
<section id="transform-into-onnx">
<h2>Transform into ONNX<a class="headerlink" href="#transform-into-onnx" title="Permalink to this heading">#</a></h2>
<p>In order to calculate the <cite>scoring</cite> we need to transform the model to <cite>ONNX</cite>
format first. We will use the
<a class="reference external" href="https://onnx.ai/sklearn-onnx/api_summary.html?highlight=to_onnx#skl2onnx.to_onnx">skl2onnx.to_onnx</a>
function of the <a class="reference external" href="https://onnx.ai/sklearn-onnx/index.html">sklearn-onnx</a>
library for that.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transform to ONNX format</span>
<span class="n">onnx_model</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">X_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
    <span class="n">target_opset</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>We now proceed to the calculation of the score. This is done by modifying the
ONNX graph, removing the current output of the model and adding nodes to
compute the desired output.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove all defined outputs</span>
<span class="k">while</span> <span class="n">onnx_model</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">onnx_model</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

<span class="c1"># Remove node ZipMap since it won&#39;t be necessary</span>
<span class="n">n_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">onnx_model</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_nodes</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">onnx_model</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;ZipMap&#39;</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">onnx_model</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">break</span>

<span class="c1"># Define the outputs by adding proper nodes</span>

<span class="n">onnx_model</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">make_node</span><span class="p">(</span>
        <span class="s1">&#39;Constant&#39;</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;output_pos&#39;</span><span class="p">],</span>
        <span class="n">value_int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">onnx_model</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">make_node</span><span class="p">(</span>
        <span class="s1">&#39;ArrayFeatureExtractor&#39;</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;probabilities&#39;</span><span class="p">,</span> <span class="s1">&#39;output_pos&#39;</span><span class="p">],</span>
        <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;output_probability_at&#39;</span><span class="p">],</span>
        <span class="n">domain</span><span class="o">=</span><span class="n">ONNX_ML_DOMAIN</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">onnx_model</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
    <span class="n">make_tensor_value_info</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;output_probability_at&#39;</span><span class="p">,</span>
        <span class="n">elem_type</span><span class="o">=</span><span class="n">TensorProto</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to <a class="reference external" href="https://onnx.ai/onnx/intro/">ONNX documentation</a> to learn more
about to manipulate an <cite>ONNX</cite> graph.</p>
</div>
<p>We can check is the transformed model works correctly by comparing the
predictions of the <code class="docutils literal notranslate"><span class="pre">model</span></code> and <code class="docutils literal notranslate"><span class="pre">onnx_model</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predict with ONNX model</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">InferenceSession</span><span class="p">(</span><span class="n">onnx_model</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">())</span>
<span class="n">input_name</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get_inputs</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="n">input_name</span><span class="p">:</span> <span class="n">X_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)})</span>
<span class="n">onnx_scores</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Predict with model</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Compare predictions</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">prediction_validation</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">scores</span> <span class="o">-</span> <span class="n">onnx_scores</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Predictions are similar: </span><span class="si">{</span><span class="n">prediction_validation</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">Predictions are similar: True</span>
</pre></div>
</div>
<p>Great, seems our <code class="docutils literal notranslate"><span class="pre">onnx_model</span></code> is valid, now letâ€™s to save it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">MODEL_FILE</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">onnx_model</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="register-the-model">
<h2>Register the model<a class="headerlink" href="#register-the-model" title="Permalink to this heading">#</a></h2>
<p>Once the model has been built and saved, it must be registered on the
Devo platform in order to exploit it. We will use the ML Model Manager Client
for that.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the mlmm client</span>
<span class="n">mlmm</span> <span class="o">=</span> <span class="n">create_client_from_token</span><span class="p">(</span><span class="n">DEVO_MLMM_URL</span><span class="p">,</span> <span class="n">DEVO_TOKEN</span><span class="p">)</span>

<span class="c1"># register the model</span>
<span class="n">mlmm</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span>
    <span class="n">MODEL_NAME</span><span class="p">,</span>
    <span class="n">engines</span><span class="o">.</span><span class="n">ONNX</span><span class="p">,</span>
    <span class="n">MODEL_FILE</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="n">MODEL_DESCRIPTION</span><span class="p">,</span>
    <span class="n">force</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to <a class="reference internal" href="../user_guide/index.html#user-s-guide"><span class="std std-ref">Userâ€™s Guide</span></a> of this documentation to
learn more about the ML Model Manager Client.</p>
</div>
<p>So far we are ready to exploit our model, i.e. to score domains according to
how malicious they are.</p>
</section>
<section id="scoring-domains">
<h2>Scoring domains<a class="headerlink" href="#scoring-domains" title="Permalink to this heading">#</a></h2>
<p>One way to evaluate a model is to use the <code class="docutils literal notranslate"><span class="pre">mlevalmodel(...)</span></code> operator when
querying a table. The <code class="docutils literal notranslate"><span class="pre">mlevalmodel(...)</span></code> operator is capable of evaluating
machine learning models and is available in the Devo query engine.</p>
<p>We are going to use the <code class="docutils literal notranslate"><span class="pre">demo.ecommerce.data</span></code> table, which contains the
<code class="docutils literal notranslate"><span class="pre">referralUri</span></code> field, from which we can extract the domain we want to score.</p>
<p>A query that might be worthwhile would be something like this.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;from demo.ecommerce.data</span>
<span class="s1">select</span>
<span class="s1">    eventdate,</span>
<span class="s1">    split(referralUri, &quot;/&quot;, 2) as domain</span>
<span class="s1">group by domain every -</span>
<span class="s1">select</span>
<span class="s1">    float4(length(domain)) as length,</span>
<span class="s1">    float4(shannonentropy(domain)) as entropy,</span>
<span class="s1">    float4(countbyfilter(domain, &quot;aeiouAEIOU&quot;) / length) as vowel_proportion,</span>
<span class="s1">    at(mlevalmodel(</span>
<span class="s1">        &quot;</span><span class="si">{</span><span class="n">DOMAIN</span><span class="si">}</span><span class="s1">&quot;,</span>
<span class="s1">        &quot;</span><span class="si">{</span><span class="n">MODEL_NAME</span><span class="si">}</span><span class="s1">&quot;,</span>
<span class="s1">        [length, vowel_proportion, entropy]</span>
<span class="s1">    ), 0) as score</span>
<span class="s1">&#39;&#39;&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to <a class="reference external" href="https://docs.devo.com/space/latest/95191261/Build+a+query+using+LINQ">Build a query using LINQ</a>
to learn more about queries.</p>
</div>
<p>Well, now we just need to create an access to the Devo API and launch the
query.</p>
<p>With the <a class="reference external" href="https://github.com/DevoInc/python-sdk">Devo Python SDK</a>
we can execute queries against the Devo platform easily
and securely.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a Devo API client</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span>
    <span class="n">auth</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;token&quot;</span><span class="p">:</span> <span class="n">DEVO_TOKEN</span><span class="p">},</span>
    <span class="n">address</span><span class="o">=</span><span class="n">DEVO_API_URL</span><span class="p">,</span>
    <span class="n">config</span><span class="o">=</span><span class="n">ClientConfig</span><span class="p">(</span>
        <span class="n">response</span><span class="o">=</span><span class="s2">&quot;json/simple/compact&quot;</span><span class="p">,</span>
        <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">processor</span><span class="o">=</span><span class="n">SIMPLECOMPACT_TO_OBJ</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
    <span class="n">dates</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;from&#39;</span><span class="p">:</span> <span class="s1">&#39;now() - 1 * hour()&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="s1">&#39;now()&#39;</span><span class="p">}</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)</span>
</pre></div>
</div>
<p>You will see the scoring like the following depending on the contents of the
<code class="docutils literal notranslate"><span class="pre">demo.ecommerce.data</span></code> table.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="go">www.bing.com -&gt; 0.0182034969329834</span>
<span class="go">www.google.com -&gt; 0.5790193676948547</span>
<span class="go">www.logcasts.com -&gt; 0.24745863676071167</span>
<span class="go">www.logtrust.com -&gt; 0.28057998418807983</span>
<span class="gp">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to <a class="reference external" href="https://docs.devo.com/space/latest/95128275">Query API</a>
to learn more about the Devo Query API.</p>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Devo ML Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">DGA domain scoring (GB-ONNX)</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#setup">Setup</a></li>
<li><a class="reference internal" href="#prepare-the-data">Prepare the data</a></li>
<li><a class="reference internal" href="#build-the-model">Build the model</a></li>
<li><a class="reference internal" href="#transform-into-onnx">Transform into ONNX</a></li>
<li><a class="reference internal" href="#register-the-model">Register the model</a></li>
<li><a class="reference internal" href="#scoring-domains">Scoring domains</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    </body>
</html>